<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<HTML>
<HEAD>
<TITLE>ClioPatria: the SWI-Prolog Semantic Web Server</TITLE><STYLE type="text/css">
/* Style sheet for SWI-Prolog latex2html
*/

dd.defbody
{ margin-bottom: 1em;
}

dt.pubdef
{ background-color: #c5e1ff;
}

.bib dd
{ margin-bottom: 1em;
}

.bib dt
{ float: left;
margin-right: 1.3ex;
}

pre.code
{ margin-left: 1.5em;
margin-right: 1.5em;
border: 1px dotted;
padding-top: 5px;
padding-left: 5px;
padding-bottom: 5px;
background-color: #f8f8f8;
}

div.navigate
{ text-align: center;
background-color: #f0f0f0;
border: 1px dotted;
padding: 5px;
}

div.title
{ text-align: center;
padding-bottom: 1em;
font-size: 200%;
font-weight: bold;
}

div.author
{ text-align: center;
font-style: italic;
}

div.abstract
{ margin-top: 2em;
background-color: #f0f0f0;
border: 1px dotted;
padding: 5px;
margin-left: 10%; margin-right:10%;
}

div.abstract-title
{ text-align: center;
padding: 5px;
font-size: 120%;
font-weight: bold;
}

div.toc-h1
{ font-size: 200%;
font-weight: bold;
}

div.toc-h2
{ font-size: 120%;
font-weight: bold;
margin-left: 2em;
}

div.toc-h3
{ font-size: 100%;
font-weight: bold;
margin-left: 4em;
}

div.toc-h4
{ font-size: 100%;
margin-left: 6em;
}

span.sec-nr
{ 
}

span.sec-title
{ 
}

span.pred-ext
{ font-weight: bold;
}

span.pred-tag
{ float: right;
font-size: 80%;
font-style: italic;
color: #202020;
}

/* Footnotes */

sup.fn { color: blue; text-decoration: underline; }
span.fn-text { display: none; }
sup.fn span {display: none;}
sup:hover span 
{ display: block !important;
position: absolute; top: auto; left: auto; width: 80%;
color: #000; background: white;
border: 2px solid;
padding: 5px; margin: 10px; z-index: 100;
font-size: smaller;
}
</STYLE>
</HEAD>
<BODY BGCOLOR="white"> 

<P>
<DIV class="title">ClioPatria: the SWI-Prolog Semantic Web Server</DIV>
<DIV class="author">Jan Wielemaker <BR>
University of Amsterdam, VU University of Amsterdam <BR>
The Netherlands <BR>
E-mail: <A class="url" href="mailto:J.Wielemaker@cs.vu.nl">J.Wielemaker@cs.vu.nl</A></DIV>
<DIV class="abstract">
<DIV class="abstract-title">Abstract</DIV> SWI-Prolog offers an 
extensive library for loading, saving and querying Semantic Web 
documents called the `<A class="url" href="http://www.swi-prolog.org/pldoc/package/semweb.html">semweb</A>' 
package. Internally, the query language is `Prolog', building on top of 
an efficient implementation of a predicate <A NAME="idx:rdf3:1"></A><SPAN class="pred-ext">rdf/3</SPAN> 
expressing the content of the triple store.

<P>ClioPatria provides a ready-ro-run web-server on top of this 
infrastructure. The web-server contains a SPARQL endpoint, user 
management and web-based tools to help the developer analysing the 
loaded RDF.
</DIV>

<H1><A NAME="document-contents">Table of Contents</A></H1>

<DIV class="toc">
<DIV class="toc-h2"><A class="sec" href="#sec:1"><SPAN class="sec-nr">1</SPAN> <SPAN class="sec-title">Introduction</SPAN></A></DIV>
<DIV class="toc-h2"><A class="sec" href="#sec:2"><SPAN class="sec-nr">2</SPAN> <SPAN class="sec-title">Query 
Languages</SPAN></A></DIV>
<DIV class="toc-h3"><A class="sec" href="#sec:2.1"><SPAN class="sec-nr">2.1</SPAN> <SPAN class="sec-title">SPARQL 
Support</SPAN></A></DIV>
<DIV class="toc-h3"><A class="sec" href="#sec:2.2"><SPAN class="sec-nr">2.2</SPAN> <SPAN class="sec-title">SeRQL 
Support</SPAN></A></DIV>
<DIV class="toc-h2"><A class="sec" href="#sec:3"><SPAN class="sec-nr">3</SPAN> <SPAN class="sec-title">Installation 
and Administration</SPAN></A></DIV>
<DIV class="toc-h3"><A class="sec" href="#sec:3.1"><SPAN class="sec-nr">3.1</SPAN> <SPAN class="sec-title">Getting 
started</SPAN></A></DIV>
<DIV class="toc-h3"><A class="sec" href="#sec:3.2"><SPAN class="sec-nr">3.2</SPAN> <SPAN class="sec-title">Configuring 
the server</SPAN></A></DIV>
<DIV class="toc-h3"><A class="sec" href="#sec:3.3"><SPAN class="sec-nr">3.3</SPAN> <SPAN class="sec-title">Restarting 
from scratch: where is the data kept?</SPAN></A></DIV>
<DIV class="toc-h2"><A class="sec" href="#sec:4"><SPAN class="sec-nr">4</SPAN> <SPAN class="sec-title">Security 
issues</SPAN></A></DIV>
<DIV class="toc-h2"><A class="sec" href="#sec:5"><SPAN class="sec-nr">5</SPAN> <SPAN class="sec-title">Downloading</SPAN></A></DIV>
</DIV>

<P>

<H2><A NAME="sec:1"><SPAN class="sec-nr">1</SPAN> <SPAN class="sec-title">Introduction</SPAN></A></H2>

<P>ClioPatria unifies the SWI-Prolog general Web support and Semantic 
Web support, providing both a starting point for dedicated applications 
and a platform for exchange of RDF-based data using a standardised 
language and protocol.

<P>`Out of the box', ClioPatria can be used to load and study RDF data. 
RDF data can be studied using the interactive SPARQL interface, a graph 
browser or the Prolog toplevel.

<P>ClioPatria is first of all intended as a base-level infrastructure 
for building RDF-based applications. This is achieved by loading 
additional Prolog code that implements the required application logic on 
top of the SWI-Prolog semweb package and optionally ClioPatria 
extensions thereof. Next, there are several options to make this 
application logic available:

<P>
<UL>
<LI>Define `APIs': HTTP handlers that emit JSON or XML that is handled 
by a presentation layer that resides either in the browser (using AJAX 
technology) or in another web-server.

<P>
<LI>Define HTTP handlers that emit HTML pages, possibly enriched with 
AJAX components. This technique is used by the development tools that 
are part of ClioPatria. More information on providing web-services from 
Prolog can be found on the SWI-Prolog
<A class="url" href="http://www.swi-prolog.org/howto/http/">HOWTO pages</A>
</UL>

<P>The choice between these two options depends on external 
requirements, such as skills of the involved developers, integration 
with other software and the amount of interaction. Serving HTML pages 
from Prolog requires knowledge of HTML and CSS and the SWI-Prolog 
HTML-writer library. It provides good modularity and reuse. 
Alternatively, the UI can be programmed in e.g., flash or a generic 
JavaScript library such as YUI. This approach makes the UI independent 
from the server, but requires programming in two languages: Prolog to 
define the APIs and flash/JavaScript/... to program the UI.

<H2><A NAME="sec:2"><SPAN class="sec-nr">2</SPAN> <SPAN class="sec-title">Query 
Languages</SPAN></A></H2>

<P>ClioPatria supports two query languages:
<A class="url" href="http://www.w3.org/TR/rdf-sparql-query/">SPARQL</A> 
and
<A class="url" href="http://www.openrdf.org">SeRQL</A>. For both 
languages we provide an interactive service that presents the results as 
a human-readable HTML table and an API that presents its result as 
RDF/XML or XML according to the HTTP protocol definition for the query 
language.

<P>ClioPatria's SPARQL endpoint is intended to support clients that are 
designed for to work with a SPARQL endpoint. E.g., if an application 
requires a vocabulary browser and such a browser is available as a 
JavaScript library that formulates SPARQL queries, ClioPatria's SPARQL 
endpoints allow reuse of this component. In our experience, SPARQL often 
needs additional application logic that is located near the data to 
provide a task-specific API that drives the user interface. Locating 
this logic near the data is required to avoid protocol and latency 
overhead. RDF-based application logic is a perfect match for Prolog and 
the RDF data is much easier queried through the Prolog RDF libraries 
than through SPARQL.

<P>For both SPARQL and SeRQL, queries are translated to a complex Prolog 
goal calling <A NAME="idx:rdf3:2"></A><SPAN class="pred-ext">rdf/3</SPAN> 
to resolve edges in the graph and calls to predicates from 
rdfql/rdfql_runtime.pl that realise constraints imposed by the SeRQL <CODE>WHERE</CODE> 
clause and SPARQL <CODE>FILTER</CODE> clauses.

<H3><A NAME="sec:2.1"><SPAN class="sec-nr">2.1</SPAN> <SPAN class="sec-title">SPARQL 
Support</SPAN></A></H3>

<P>SPARQL support is based on the SPARQL specification, versioned April 
6, 2006. Status:

<P><UL COMPACT>
<LI>No optimization of literal operations. Because many SPARQL 
operations require type-translations that depend on the literal found, 
many of these operations are slow. The engine does optimize graph 
expressions.
<LI>Incomplete value-testing, notably on xsd:dateTime
<LI>Incomplete ORDER BY support. Only ascending and all values are 
compared lexically.
<LI>Passes current test-suite, except tests affected by the above or 
acknowledged as errornous.
</UL>

<H3><A NAME="sec:2.2"><SPAN class="sec-nr">2.2</SPAN> <SPAN class="sec-title">SeRQL 
Support</SPAN></A></H3>

<P>SeRQL support and compatibility is based on development version 
20040820, with additional support for the new 1.2 syntax and some of the 
built-in functions. Both SeRQL and the HTTP API are fully defined in the 
Sesame documentation.

<H2><A NAME="sec:3"><SPAN class="sec-nr">3</SPAN> <SPAN class="sec-title">Installation 
and Administration</SPAN></A></H2>

<H3><A NAME="sec:3.1"><SPAN class="sec-nr">3.1</SPAN> <SPAN class="sec-title">Getting 
started</SPAN></A></H3>

<P>Create run.pl from run.pl.in. On Unix system, run =|./configure|= to 
accompish this. On Windows, double click setup.pl. The created file 
run.pl loads and starts the server. There are several configuration 
options that may be selected by editing run.pl according to the comments 
in this file.

<P>Next, start the server by running =|./run.pl|= (Unix) or 
double-clicking run.pl (Windows). Now direct your browser to the server, 
using the default setup this is <A class="url" href="http://localhost:3020">http://localhost:3020</A>. 
If no users are defined the browser will prompt to enter the 
administrative password. After that the admin and anonymous users are 
created. Accounts can be created and modified by users with 
administrative rights through the
<EM>Admin/Users</EM> link in the menu.

<H3><A NAME="sec:3.2"><SPAN class="sec-nr">3.2</SPAN> <SPAN class="sec-title">Configuring 
the server</SPAN></A></H3>

<P>To configure the server, login as <CODE>admin</CODE> and click
<B>Admin/Settings</B>. Edit settings and hit <B>Apply</B> to save them. 
In most cases you will have to restart the server before the new 
settings take effect.<SUP class="fn">1<SPAN class="fn-text">BUG: 
indicate when and make more settings act without restarting</SPAN></SUP>.

<H3><A NAME="sec:3.3"><SPAN class="sec-nr">3.3</SPAN> <SPAN class="sec-title">Restarting 
from scratch: where is the data kept?</SPAN></A></H3>

<P>Data is kept in the following files. Each of these can be removed.

<P>
<UL>
<LI><CODE>settings.db</CODE> This keeps settings that do not have their 
default value. You can freely edit this file if the server is not 
running. Note that the settings can change the locations of the items 
below.

<P>
<LI><CODE>users.db</CODE> This keeps the registered users and their 
permissions. You can freely edit this file if the server is not running. 
Passwords are stored as MD5-hashes.

<P>
<LI><CODE>RDF-store</CODE> This directory holds backup of the RDF data. 
Each named-graph is represented by two (optional) files. The base of 
this file is an encoded version of the graph-name. The extensions are <CODE>.trp</CODE> 
for quick-load snapshots and <CODE>.jrn</CODE> for <EM>journal</EM> 
files. See the SWI-Prolog <A class="url" href="http://www.swi-prolog.org/packages/semweb.html">Semantic 
Web package</A> for details. You can freely remove a graph by removing 
both files if the server is not running. Similar, you can remove the 
journal to restore a graph to its initial state after loading it from 
the source-data.

<P>
<LI><CODE>httpd.log</CODE> Keeps a log of HTTP interactions. Note that 
on heavily loaded servers this can be a significant slow-down and the 
file can become huge. Logging can be disabled either by not loading 
library(http/http_log) in the startup script (see run.pl) or by clearing <I>File 
in which to log HTTP requests</I> in the settings-page.

<P>On Unix systems, this file can be moved or removed at any time. The 
server will start a new log-file. On Windows this will give a sharing 
violation.<SUP class="fn">2<SPAN class="fn-text">The HTTP log library 
needs a portable mechanism to deal with growing logfiles.</SPAN></SUP>
</UL>

<H2><A NAME="sec:4"><SPAN class="sec-nr">4</SPAN> <SPAN class="sec-title">Security 
issues</SPAN></A></H2>

<P>HTTP Communication with the server, including usernames and 
passwords, is in cleartext and therefore sensitive to sniffing. The 
overall security of the server is unknown. It is advised to run the 
server as user with minimal access rights, only providing write access 
to the user database file.

<H2><A NAME="sec:5"><SPAN class="sec-nr">5</SPAN> <SPAN class="sec-title">Downloading</SPAN></A></H2>

<P>ClioPatria is available from its
<A class="url" href="http://git-scm.com/">GIT</A>
<A class="url" href="http://www.swi-prolog.org/git/ClioPatria.git">repository</A> 
using the following commands:

<PRE class="code">
% git clone git://www.swi-prolog.org/home/pl/git/ClioPatria.git
</PRE>

<H3>Acknowledgements</H3>

<P>The SeRQL server has been realised as part of the <A class="url" href="http://www.hops-fp6.org">HOPS 
project</A> and could not have been done without Sesame and feedback 
from Jeen Broekstra and Maarten Menken from the Free University of 
Amsterdam (VU). Adding SPARQL support has been realised as part of the 
E-culture sub-project of Dutch MultiMedia project. Overall cleanup and 
documentation is realised within the
<A class="url" href="http://www.europeana.eu/portal/">Europeana</A> 
project.

<H1><A NAME="document-index">Index</A></H1>

<DL>
<DT><STRONG>R</STRONG></DT>
<DD>
</DD>
<DT>rdf/3</DT>
<DD>
<A class="idx" href="#idx:rdf3:1"></A> <A class="idx" href="#idx:rdf3:2">2</A></DD>
</DL>

</BODY></HTML>